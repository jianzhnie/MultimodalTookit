'''
Author: jianzhnie
Date: 2021-11-10 18:34:33
LastEditTime: 2021-11-10 18:43:27
LastEditors: jianzhnie
Description:

'''
import timm

_all__ = ['get_model', 'get_model_list']


def get_model(name, **kwargs):
    """Returns a pre-defined model by name
    Parameters
    ----------
    name : str
        Name of the model.
    pretrained : bool
        Whether to load the pretrained weights for model.
    root : str, default '~/.encoding/models'
        Location for keeping the model parameters.
    Returns
    -------
    Module:
        The model.
    """

    name = name.lower()
    timm_models = timm.list_models(pretrained=True)
    if name in timm_models:
        model = timm.create_model(name, **kwargs)
    else:
        raise ValueError('%s\n\t%s' %
                         (str(name), '\n\t'.join(sorted(timm_models))))
    return model


def get_model_list():
    """Get the entire list of model names in model_zoo.
    Returns
    -------
    list of str
        Entire list of model names in model_zoo.
    """
    timm_models = timm.list_models(pretrained=True)
    return list(timm_models)  # + list(torchvison_models)


def get_model_input_size(model_name):
    model_inputsize = {
        'adv_inception_v3': 299,
        'cait_m36_384': 384,
        'cait_m48_448': 448,
        'cait_s24_224': 224,
        'cait_s24_384': 384,
        'cait_s36_384': 384,
        'cait_xs24_384': 384,
        'cait_xxs24_224': 224,
        'cait_xxs24_384': 384,
        'cait_xxs36_224': 224,
        'cait_xxs36_384': 384,
        'coat_lite_mini': 224,
        'coat_lite_tiny': 224,
        'cspdarknet53': 256,
        'cspresnet50': 256,
        'cspresnext50': 224,
        'densenet121': 224,
        'densenet161': 224,
        'densenet169': 224,
        'densenet201': 224,
        'densenetblur121d': 224,
        'dla102': 224,
        'dla102x': 224,
        'dla102x2': 224,
        'dla169': 224,
        'dla34': 224,
        'dla46_c': 224,
        'dla46x_c': 224,
        'dla60': 224,
        'dla60_res2net': 224,
        'dla60_res2next': 224,
        'dla60x': 224,
        'dla60x_c': 224,
        'dm_nfnet_f0': 256,
        'dm_nfnet_f1': 320,
        'dm_nfnet_f2': 352,
        'dm_nfnet_f3': 416,
        'dm_nfnet_f4': 512,
        'dm_nfnet_f5': 544,
        'dm_nfnet_f6': 576,
        'dpn107': 224,
        'dpn131': 224,
        'dpn68': 224,
        'dpn68b': 224,
        'dpn92': 224,
        'dpn98': 224,
        'eca_nfnet_l0': 288,
        'eca_nfnet_l1': 320,
        'ecaresnet101d': 224,
        'ecaresnet101d_pruned': 224,
        'ecaresnet269d': 352,
        'ecaresnet26t': 320,
        'ecaresnet50d': 224,
        'ecaresnet50d_pruned': 224,
        'ecaresnet50t': 320,
        'ecaresnetlight': 224,
        'efficientnet_b0': 224,
        'efficientnet_b1': 256,
        'efficientnet_b1_pruned': 240,
        'efficientnet_b2': 288,
        'efficientnet_b2_pruned': 260,
        'efficientnet_b3': 320,
        'efficientnet_b3_pruned': 300,
        'efficientnet_b4': 384,
        'efficientnet_el': 300,
        'efficientnet_el_pruned': 300,
        'efficientnet_em': 240,
        'efficientnet_es': 224,
        'efficientnet_es_pruned': 224,
        'efficientnet_lite0': 224,
        'efficientnet_v2s': 384,
        'ens_adv_inception_resnet_v2': 299,
        'ese_vovnet19b_dw': 224,
        'ese_vovnet39b': 224,
        'fbnetc_100': 224,
        'gernet_l': 256,
        'gernet_m': 224,
        'gernet_s': 224,
        'ghostnet_100': 224,
        'gluon_inception_v3': 299,
        'gluon_resnet101_v1b': 224,
        'gluon_resnet101_v1c': 224,
        'gluon_resnet101_v1d': 224,
        'gluon_resnet101_v1s': 224,
        'gluon_resnet152_v1b': 224,
        'gluon_resnet152_v1c': 224,
        'gluon_resnet152_v1d': 224,
        'gluon_resnet152_v1s': 224,
        'gluon_resnet18_v1b': 224,
        'gluon_resnet34_v1b': 224,
        'gluon_resnet50_v1b': 224,
        'gluon_resnet50_v1c': 224,
        'gluon_resnet50_v1d': 224,
        'gluon_resnet50_v1s': 224,
        'gluon_resnext101_32x4d': 224,
        'gluon_resnext101_64x4d': 224,
        'gluon_resnext50_32x4d': 224,
        'gluon_senet154': 224,
        'gluon_seresnext101_32x4d': 224,
        'gluon_seresnext101_64x4d': 224,
        'gluon_seresnext50_32x4d': 224,
        'gluon_xception65': 299,
        'hardcorenas_a': 224,
        'hardcorenas_b': 224,
        'hardcorenas_c': 224,
        'hardcorenas_d': 224,
        'hardcorenas_e': 224,
        'hardcorenas_f': 224,
        'hrnet_w18': 224,
        'hrnet_w18_small': 224,
        'hrnet_w18_small_v2': 224,
        'hrnet_w30': 224,
        'hrnet_w32': 224,
        'hrnet_w40': 224,
        'hrnet_w44': 224,
        'hrnet_w48': 224,
        'hrnet_w64': 224,
        'ig_resnext101_32x16d': 224,
        'ig_resnext101_32x32d': 224,
        'ig_resnext101_32x48d': 224,
        'ig_resnext101_32x8d': 224,
        'inception_resnet_v2': 299,
        'inception_v3': 299,
        'inception_v4': 299,
        'legacy_senet154': 224,
        'legacy_seresnet101': 224,
        'legacy_seresnet152': 224,
        'legacy_seresnet18': 224,
        'legacy_seresnet34': 224,
        'legacy_seresnet50': 224,
        'legacy_seresnext101_32x4d': 224,
        'legacy_seresnext26_32x4d': 224,
        'legacy_seresnext50_32x4d': 224,
        'mixer_b16_224': 224,
        'mixer_l16_224': 224,
        'mixer_b16_224_in21k': 224,
        'mixer_l16_224_in21k': 224,
        'mixnet_l': 224,
        'mixnet_m': 224,
        'mixnet_s': 224,
        'mixnet_xl': 224,
        'mnasnet_100': 224,
        'mobilenetv2_100': 224,
        'mobilenetv2_110d': 224,
        'mobilenetv2_120d': 224,
        'mobilenetv2_140': 224,
        'mobilenetv3_large_100': 224,
        'mobilenetv3_large_100_miil': 224,
        'mobilenetv3_large_100_miil_in21k': 224,
        'mobilenetv3_rw': 224,
        'nasnetalarge': 331,
        'nf_regnet_b1': 288,
        'nf_resnet50': 288,
        'nfnet_l0': 288,
        'pit_b_224': 224,
        'pit_b_distilled_224': 224,
        'pit_s_224': 224,
        'pit_s_distilled_224': 224,
        'pit_ti_224': 224,
        'pit_ti_distilled_224': 224,
        'pit_xs_224': 224,
        'pit_xs_distilled_224': 224,
        'pnasnet5large': 331,
        'regnetx_002': 224,
        'regnetx_004': 224,
        'regnetx_006': 224,
        'regnetx_008': 224,
        'regnetx_016': 224,
        'regnetx_032': 224,
        'regnetx_040': 224,
        'regnetx_064': 224,
        'regnetx_080': 224,
        'regnetx_120': 224,
        'regnetx_160': 224,
        'regnetx_320': 224,
        'regnety_002': 224,
        'regnety_004': 224,
        'regnety_006': 224,
        'regnety_008': 224,
        'regnety_016': 224,
        'regnety_032': 288,
        'regnety_040': 224,
        'regnety_064': 224,
        'regnety_080': 224,
        'regnety_120': 224,
        'regnety_160': 288,
        'regnety_320': 224,
        'repvgg_a2': 224,
        'repvgg_b0': 224,
        'repvgg_b1': 224,
        'repvgg_b1g4': 224,
        'repvgg_b2': 224,
        'repvgg_b2g4': 224,
        'repvgg_b3': 224,
        'repvgg_b3g4': 224,
        'res2net101_26w_4s': 224,
        'res2net50_14w_8s': 224,
        'res2net50_26w_4s': 224,
        'res2net50_26w_6s': 224,
        'res2net50_26w_8s': 224,
        'res2net50_48w_2s': 224,
        'res2next50': 224,
        'resnest101e': 256,
        'resnest14d': 224,
        'resnest200e': 320,
        'resnest269e': 416,
        'resnest26d': 224,
        'resnest50d': 224,
        'resnest50d_1s4x24d': 224,
        'resnest50d_4s2x40d': 224,
        'resnet101d': 320,
        'resnet152d': 320,
        'resnet18': 224,
        'resnet18d': 224,
        'resnet200d': 320,
        'resnet26': 224,
        'resnet26d': 224,
        'resnet34': 224,
        'resnet34d': 224,
        'resnet50': 224,
        'resnet50d': 224,
        'resnetblur50': 224,
        'resnetrs101': 288,
        'resnetrs152': 320,
        'resnetrs200': 320,
        'resnetrs270': 352,
        'resnetrs350': 384,
        'resnetrs420': 416,
        'resnetrs50': 224,
        'resnetv2_101x1_bitm': 480,
        'resnetv2_101x3_bitm': 480,
        'resnetv2_152x2_bitm': 480,
        'resnetv2_152x4_bitm': 480,
        'resnetv2_50x1_bitm': 480,
        'resnetv2_50x3_bitm': 480,
        'resnetv2_50x1_bitm_in21k': 480,
        'resnetv2_50x3_bitm_in21k': 480,
        'resnetv2_101x1_bitm_in21k': 480,
        'resnetv2_101x3_bitm_in21k': 480,
        'resnetv2_152x2_bitm_in21k': 480,
        'resnetv2_152x4_bitm_in21k': 480,
        'resnext101_32x8d': 224,
        'resnext50_32x4d': 224,
        'resnext50d_32x4d': 224,
        'rexnet_100': 224,
        'rexnet_130': 224,
        'rexnet_150': 224,
        'rexnet_200': 224,
        'selecsls42b': 224,
        'selecsls60': 224,
        'selecsls60b': 224,
        'semnasnet_100': 224,
        'seresnet152d': 320,
        'seresnet50': 224,
        'seresnext26d_32x4d': 224,
        'seresnext26t_32x4d': 224,
        'seresnext50_32x4d': 224,
        'skresnet18': 224,
        'skresnet34': 224,
        'skresnext50_32x4d': 224,
        'spnasnet_100': 224,
        'ssl_resnet18': 224,
        'ssl_resnet50': 224,
        'ssl_resnext101_32x16d': 224,
        'ssl_resnext101_32x4d': 224,
        'ssl_resnext101_32x8d': 224,
        'ssl_resnext50_32x4d': 224,
        'swin_base_patch4_window12_384': 384,
        'swin_base_patch4_window7_224': 224,
        'swin_large_patch4_window12_384': 384,
        'swin_large_patch4_window7_224': 224,
        'swin_small_patch4_window7_224': 224,
        'swin_tiny_patch4_window7_224': 224,
        'swin_base_patch4_window7_224_in22k': 224,
        'swin_base_patch4_window12_384_in22k': 384,
        'swin_large_patch4_window7_224_in22k': 224,
        'swin_large_patch4_window12_384_in22k': 384,
        'swsl_resnet18': 224,
        'swsl_resnet50': 224,
        'swsl_resnext101_32x16d': 224,
        'swsl_resnext101_32x4d': 224,
        'swsl_resnext101_32x8d': 224,
        'swsl_resnext50_32x4d': 224,
        'tf_efficientnet_b0': 224,
        'tf_efficientnet_b0_ap': 224,
        'tf_efficientnet_b0_ns': 224,
        'tf_efficientnet_b1': 240,
        'tf_efficientnet_b1_ap': 240,
        'tf_efficientnet_b1_ns': 240,
        'tf_efficientnet_b2': 260,
        'tf_efficientnet_b2_ap': 260,
        'tf_efficientnet_b2_ns': 260,
        'tf_efficientnet_b3': 300,
        'tf_efficientnet_b3_ap': 300,
        'tf_efficientnet_b3_ns': 300,
        'tf_efficientnet_b4': 380,
        'tf_efficientnet_b4_ap': 380,
        'tf_efficientnet_b4_ns': 380,
        'tf_efficientnet_b5': 456,
        'tf_efficientnet_b5_ap': 456,
        'tf_efficientnet_b5_ns': 456,
        'tf_efficientnet_b6': 528,
        'tf_efficientnet_b6_ap': 528,
        'tf_efficientnet_b6_ns': 528,
        'tf_efficientnet_b7': 600,
        'tf_efficientnet_b7_ap': 600,
        'tf_efficientnet_b7_ns': 600,
        'tf_efficientnet_b8': 672,
        'tf_efficientnet_b8_ap': 672,
        'tf_efficientnet_cc_b0_4e': 224,
        'tf_efficientnet_cc_b0_8e': 224,
        'tf_efficientnet_cc_b1_8e': 240,
        'tf_efficientnet_el': 300,
        'tf_efficientnet_em': 240,
        'tf_efficientnet_es': 224,
        'tf_efficientnet_l2_ns': 800,
        'tf_efficientnet_l2_ns_475': 475,
        'tf_efficientnet_lite0': 224,
        'tf_efficientnet_lite1': 240,
        'tf_efficientnet_lite2': 260,
        'tf_efficientnet_lite3': 300,
        'tf_efficientnet_lite4': 380,
        'tf_efficientnetv2_b0': 192,
        'tf_efficientnetv2_b1': 192,
        'tf_efficientnetv2_b2': 208,
        'tf_efficientnetv2_b3': 240,
        'tf_efficientnetv2_l': 384,
        'tf_efficientnetv2_l_in21ft1k': 384,
        'tf_efficientnetv2_l_in21k': 384,
        'tf_efficientnetv2_m': 384,
        'tf_efficientnetv2_m_in21ft1k': 384,
        'tf_efficientnetv2_m_in21k': 384,
        'tf_efficientnetv2_s': 300,
        'tf_efficientnetv2_s_in21ft1k': 300,
        'tf_efficientnetv2_s_in21k': 300,
        'tf_inception_v3': 299,
        'tf_mixnet_l': 224,
        'tf_mixnet_m': 224,
        'tf_mixnet_s': 224,
        'tf_mobilenetv3_large_075': 224,
        'tf_mobilenetv3_large_100': 224,
        'tf_mobilenetv3_large_minimal_100': 224,
        'tf_mobilenetv3_small_075': 224,
        'tf_mobilenetv3_small_100': 224,
        'tf_mobilenetv3_small_minimal_100': 224,
        'tnt_s_patch16_224': 224,
        'tresnet_l': 224,
        'tresnet_l_448': 448,
        'tresnet_m': 224,
        'tresnet_m_448': 448,
        'tresnet_xl': 224,
        'tresnet_xl_448': 448,
        'tresnet_m_miil_in21k': 448,
        'tv_densenet121': 224,
        'tv_resnet101': 224,
        'tv_resnet152': 224,
        'tv_resnet34': 224,
        'tv_resnet50': 224,
        'tv_resnext50_32x4d': 224,
        'vgg11': 224,
        'vgg11_bn': 224,
        'vgg13': 224,
        'vgg13_bn': 224,
        'vgg16': 224,
        'vgg16_bn': 224,
        'vgg19': 224,
        'vgg19_bn': 224,
        'vit_base_patch16_224': 224,
        'vit_base_patch16_224_miil': 224,
        'vit_base_patch16_384': 384,
        'vit_base_patch32_384': 384,
        'vit_base_r50_s16_384': 384,
        'vit_base_patch16_224_in21k': 224,
        'vit_base_patch16_224_miil_in21k': 224,
        'vit_base_patch32_224_in21k': 224,
        'vit_base_r50_s16_224_in21k': 224,
        'vit_large_patch16_224_in21k': 224,
        'vit_large_patch32_224_in21k': 224,
        'vit_deit_base_distilled_patch16_224': 224,
        'vit_deit_base_distilled_patch16_384': 384,
        'vit_deit_base_patch16_224': 224,
        'vit_deit_base_patch16_384': 384,
        'vit_deit_small_distilled_patch16_224': 224,
        'vit_deit_small_patch16_224': 224,
        'vit_deit_tiny_distilled_patch16_224': 224,
        'vit_deit_tiny_patch16_224': 224,
        'vit_large_patch16_224': 224,
        'vit_large_patch16_384': 384,
        'vit_large_patch32_384': 384,
        'vit_small_patch16_224': 224,
        'wide_resnet101_2': 224,
        'wide_resnet50_2': 224,
        'xception': 299,
        'xception41': 299,
        'xception65': 299,
        'xception71': 299
    }
    input_size = model_inputsize.get(model_name, 224)
    return input_size


if __name__ == '__main__':
    models = get_model_list()
    print(models)
    print(len(models))
    net = get_model('efficientnet_b1', pretrained=False)
    print(net)
